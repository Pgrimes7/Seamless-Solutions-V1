@page
@model Lab1484.Pages.GrantsAndProjectsModel
@{
}
<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="YOUR DESCRIPTION HERE">
    <meta name="author" content="YOUR NAME HERE">
    <title>Test</title>

    <!-- LOAD BOOTSTRAP CSS - DO NOT DELETE -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- END LOADING BOOTSTRAP CSS -->
    <!-- Custom styles - add your own CSS to this stylesheet -->
    <link href="~/css/style.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">

    <!-- DO NOT DELETE -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/4ccc3672e0.js" crossorigin="anonymous"></script>
    <script src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <!-- DO NOT DELETE -->
</head>

@*<div class="container mt-4">
    <!-- Tabs Navigation -->
    <ul class="nav nav-tabs" id="myTabs">
        <li class="nav-item">
            <a class="nav-link active" id="tab1-tab" data-bs-toggle="tab" href="#tab1">Grants</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="tab2-tab" data-bs-toggle="tab" href="#tab2">Projects</a>
        </li>
    </ul>

    <!-- Tab Content -->
    <div class="tab-content mt-3">
        <!-- First Tab -->
        <div class="tab-pane fade show active" id="tab1">
            <h3>Tab 1 Content</h3>
            <p>This is content for the first tab.</p>
        </div>

        <!-- Second Tab -->
        <div class="tab-pane fade" id="tab2">
            <h3>Tab 2 Content</h3>
            <p>This is content for the second tab.</p>
        </div>
    </div>
</div>*@





<body>

    <main>




        <div class="container-fluid">
            <div class="row flex-nowrap">


                <!--main content div-->
                <div class="col py-3">
                    @if (Model.CreateOrEditGAndPSuccess != null)
                    {
                        <div id="success-alert" class="alert alert-success alert-dismissible fade show" role="alert">
                            @Model.CreateOrEditGAndPSuccess
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>
                    }
                    @if (Model.CreateOrEditGAndPFailure != null)
                    {
                        <div id="failure-alert" class="alert alert-danger alert-dismissible fade show" role="alert">
                            @Model.CreateOrEditGAndPFailure
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>
                    }

                    @if (Model.CreateOrEditProjectSuccess != null)
                    {
                        <div id="success-alert" class="alert alert-success alert-dismissible fade show" role="alert">
                            @Model.CreateOrEditProjectSuccess
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>
                    }
                    @if (Model.CreateOrEditProjectFailure != null)
                    {
                        <div id="failure-alert" class="alert alert-danger alert-dismissible fade show" role="alert">
                            @Model.CreateOrEditProjectFailure
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>
                    }

                    <h1>Grants and Projects</h1>

                    <!--tabs-->
                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li role="presentation">
                            <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home-tab-pane" type="button" role="tab" aria-controls="home-tab-pane" aria-selected="true">
                                Grants
                            </button>
                        </li>
                        <li role="presentation">
                            <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile-tab-pane" type="button" role="tab" aria-controls="profile-tab-pane" aria-selected="false">
                                Projects
                            </button>
                        </li>
                    </ul>

                    <!--tabs content-->
                    <div class="tab-content" id="myTabContent">

                        <!--grants tab-->
                        <div class="tab-pane fade show active" id="home-tab-pane" role="tabpanel" aria-labelledby="home-tab" tabindex="0">
                            <div class="btn-toolbar my-2 mb-md-0">
                                <form class="d-flex" method="get" asp-page="/GrantsAndProjects" asp-route-tab="grants" role="search">
                                    <input class="form-control me-2 rounded-pill" type="search" name="SearchQuery" placeholder="Search" aria-label="Search">
                                    <button class="btn btn-secondary me-2 rounded-pill" type="submit">Search</button>
                                    <button class="btn btn-secondary me-2 rounded-pill" type="submit" name="SearchQuery" value="">Clear</button>
                                </form>
                                <button type="button" class="btn btn-secondary me-2 rounded-pill">
                                    <i class="fa-solid fa-filter"></i>
                                </button>

                                @*Using the GrantCreation page rather than modal for this sprint*@
                                <!--create grant button trigger modal-->
                                <button type="button" class="btn btn-primary rounded-pill" data-bs-toggle="modal" data-bs-target="#creategrantModal">
                                    Create
                                    <i class="fa-solid fa-plus"></i>
                                </button>
                                @*<a href="/GrantCreation" class="btn btn-primary rounded-pill">
                                    Create
                                    <i class="fa-solid fa-plus"></i>
                                </a>*@

                                <!--create grant modal -->
                                <div class="modal fade" id="creategrantModal" tabindex="-1" aria-labelledby="creategrantModalLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h1 class="modal-title fs-5" id="creategrantModalLabel">Create New Grant</h1>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <form method="post" asp-page-handler="InsertGrant" class="form-floating">
                                                    <div class="row mb-4">
                                                        <h6>Grant Information</h6>
                                                        <div class="col">
                                                            <div class="form-floating">
                                                                <input asp-for="newGrant.grantName" type="text" class="form-control" id="floatingName" placeholder="Grant Name">
                                                                <label for="floatingName">Grant Name</label>
                                                            </div>
                                                        </div>
                                                        <div class="col">
                                                            <div class="form-floating">
                                                                <input asp-for="newGrant.dueDate" type="date" class="form-control" id="floatingDate" placeholder="Due Date">
                                                                <label for="floatingDate">Due Date</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="form-floating mb-4">
                                                        <input asp-for="newGrant.businessName" type="text" class="form-control" id="floatingOrganization" placeholder="Funding Organization">
                                                        <label for="floatingOrganization">Funding Organization</label>
                                                    </div>
                                                    <div class="row mb-4">
                                                        <div class="col-sm-6">
                                                            <div class="form-floating">
                                                                <select asp-for="newGrant.FacultyLeadID" class="form-select" id="floatingAdmin" aria-label="Principal Investigator">
                                                                    <option value=""></option>
                                                                    @foreach (var admin in Model.AdminList)
                                                                    {
                                                                        <option value="@admin.userID">@admin.firstName @admin.lastName</option>
                                                                    }
                                                                </select>
                                                                <label for="floatingAdmin">Principal Investigator</label>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-6">
                                                            <div class="form-floating">
                                                                <select asp-for="newGrant.BusinessPartnerID" class="form-select" id="floatingPartner" aria-label="External Partner">
                                                                    @foreach (var partner in Model.PartnerList)
                                                                    {
                                                                        <option value="@partner.userID"> @partner.firstName @partner.lastName </option>
                                                                    });
                                                                </select>
                                                                <label for="floatingPartner">External Partner</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row mb-4">
                                                        <div class="col-sm-6">
                                                            <div class="form-floating">
                                                                <input asp-for="newGrant.amount" type="number" step="0.01" class="form-control" id="floatingAmount" aria-label="Grant Amount" />
                                                                <label for="floatingAmount">Grant Amount</label>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-6">
                                                            <div class="form-floating">
                                                                <select asp-for="newGrant.category" class="form-select" id="floatingCategory" aria-label="Grant Category">
                                                                    <option value="Federal">Federal</option>
                                                                    <option value="State">State</option>
                                                                    <option value="Foundation">Foundation</option>
                                                                    <option value="Other">Other</option>
                                                                </select>
                                                                <label for="floatingCategory">Grant Category</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col">
                                                        <div class="form-floating">
                                                            <select asp-for="newGrant.grantStatus" class="form-select" id="floatingStatus" aria-label="Grant Status">
                                                                <option value="Potential">Potential</option>
                                                                <option value="Funded">Funded</option>
                                                                <option value="Active">Active</option>
                                                                <option value="Rejected">Rejected</option>
                                                                <option value="Archived">Archived</option>
                                                            </select>
                                                            <label for="floatingStatus">Grant Status</label>
                                                        </div>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-outline-secondary" id="populateGrantBtn">Populate</button>
                                                        <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancel</button>
                                                        <button type="submit" class="btn btn-primary">
                                                            Create Grant
                                                        </button>
                                                    </div>
                                                </form>
                                                @*<form method="post" asp-page="/ProjectNotes">
                                                        <input type="hidden" name="ProjectID" value="@prod.ProjectID" />
                                                        <button type="submit" class="btn btn-link btn-rounded btn-sm fw-bold" data-mdb-ripple-color="dark">
                                                            Notes
                                                        </button>
                                                    </form>*@
                                            </div>
                                        </div> <!--close modal content-->
                                    </div> <!--close modal dialog-->
                                </div> <!--close modal-->
                            </div> <!--close btn toolbar-->
                            <!--grant table-->
                            <div class="table-responsive table-bordered rounded small my-2">
                                <table id="grantTable" class="table align-middle mb-0 bg-white">
                                    <thead class="bg-light">
                                        <tr>
                                            <th>
                                                <button class="sort-button btn btn-sm fw-bold shadow-none">
                                                    Grant Name
                                                </button>
                                            </th>
                                            <th>
                                                <button class="sort-button btn btn-sm fw-bold">
                                                    Principal Investigator
                                                </button>
                                            </th>
                                            <th>
                                                <button class="sort-button btn btn-sm fw-bold">
                                                    Amount
                                                </button>
                                            </th>
                                            <th>
                                                <button class="sort-button btn btn-rounded btn-sm fw-bold">
                                                    Due date
                                                </button>
                                            </th>
                                            <th>
                                                <button class="sort-button btn btn-rounded btn-sm fw-bold">
                                                    Status
                                                </button>
                                            </th>
                                            <th>
                                                <button class="sort-button btn btn-rounded btn-sm fw-bold">
                                                    Funding Organization
                                                </button>
                                            </th>
                                            <th>
                                                <button class="sort-button btn btn-sm fw-bold">
                                                    Category
                                                </button>
                                            </th>
                                            <th class="fw-bold">
                                                <button class="btn btn-rounded btn-sm fw-bold">
                                                    <i class="fa-solid fa-edit"></i>
                                                    Edit
                                                </button>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var prod in Model.GrantList)
                                        {
                                            var statusClass = prod.grantStatus?.ToLower() switch
                                            {
                                                "archived" => "badge bg-info text-dark",
                                                "active" => "badge bg-primary",
                                                "potential" => "badge bg-warning text-dark",
                                                "funded" => "badge bg-success",
                                                "rejected" => "badge bg-danger",
                                                _ => "badge bg-secondary"
                                            };

                                            <tr>
                                                <td>
                                                    <form method="post" asp-page-handler="ViewGrant">
                                                        <input type="hidden" name="grantId" value="@prod.GrantID" />
                                                        <button type="submit" class="btn btn-link btn-rounded btn-sm fw-bold" data-mdb-ripple-color="dark">
                                                            @prod.grantName
                                                        </button>
                                                    </form>
                                                </td>
                                                <td>
                                                    <div class="d-flex align-items-center">
                                                        @*<img src="https://mdbootstrap.com/img/new/avatars/8.jpg" alt="" style="width: 45px; height: 45px" class="rounded-circle">*@
                                                        <div class="ms-3">
                                                            <p class="fw-bold mb-1">@prod.facultyName</p>
                                                            <p class="text-muted mb-0">@prod.facultyEmail</p>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td>@prod.amount.ToString("C")</td>
                                                <td>@prod.dueDate.ToShortDateString()</td>
                                                <td><span class="@statusClass">@prod.grantStatus</span></td>
                                                <td>@prod.businessName</td>
                                                <td>@prod.category</td>
                                                <td>
                                                    <!--edit grant button trigger modal-->
                                                    <button type="button"
                                                            class="btn btn-link btn-rounded btn-sm fw-bold"
                                                            data-bs-toggle="modal"
                                                            data-bs-target="#editgrantModal"
                                                            data-grant-id="@prod.GrantID"
                                                            data-grant-name="@prod.grantName"
                                                            data-grant-duedate="@prod.dueDate.ToString("yyyy-MM-dd")"
                                                            data-grant-business="@prod.businessName"
                                                            data-grant-category="@prod.category"
                                                            data-grant-status="@prod.grantStatus"
                                                            data-grant-amount="@prod.amount">
                                                        <i class="fa-solid fa-pen-to-square"></i>
                                                    </button>
                                                </td>

                                            </tr>
                                        }
                                    </tbody>


                                </table>
                            </div> <!--close table div-->
                            <!--edit grant modal -->
                            <div class="modal fade" id="editgrantModal" tabindex="-1" aria-labelledby="editgrantModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h1 class="modal-title fs-5" id="editgrantModalLabel">Save Changes</h1>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <form method="post" asp-page-handler="UpdateGrant" class="form-floating">
                                                <input type="hidden" asp-for="newGrant.GrantID" name="newGrant.GrantID" />
                                                <div class="row mb-4">
                                                    <h6>Grant Information</h6>
                                                    <div class="col">
                                                        <div class="form-floating">
                                                            <input asp-for="newGrant.grantName" type="text" class="form-control" id="floatingName" placeholder="Grant Name">
                                                            <label for="floatingName">Grant Name</label>
                                                        </div>
                                                    </div>
                                                    <div class="col">
                                                        <div class="form-floating">
                                                            <input asp-for="newGrant.dueDate" type="date" class="form-control" id="floatingDate" placeholder="Due Date">
                                                            <label for="floatingDate">Due Date</label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-floating mb-4">
                                                    <input asp-for="newGrant.businessName" type="text" class="form-control" id="floatingOrganization" placeholder="Funding Organization">
                                                    <label for="floatingOrganization">Funding Organization</label>
                                                </div>
                                                <div class="row mb-4">
                                                    <div class="col-sm-6">
                                                        <div class="form-floating">
                                                            <select asp-for="newGrant.FacultyLeadID" class="form-select" id="floatingAdmin" aria-label="Principal Investigator">
                                                                @foreach (var admin in Model.AdminList)
                                                                {
                                                                    <option value="@admin.userID"> @admin.firstName @admin.lastName </option>
                                                                });
                                                            </select>
                                                            <label for="floatingAdmin">Principal Investigator</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <div class="form-floating">
                                                            <select asp-for="newGrant.BusinessPartnerID" class="form-select" id="floatingPartner" aria-label="External Partner">
                                                                @foreach (var partner in Model.PartnerList)
                                                                {
                                                                    <option value="@partner.userID"> @partner.firstName @partner.lastName </option>
                                                                });
                                                            </select>
                                                            <label for="floatingPartner">External Partner</label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row mb-4">
                                                    <div class="col-sm-6">
                                                        <div class="form-floating">
                                                            <input asp-for="newGrant.amount" type="number" step="0.01" class="form-control" id="floatingAmount" aria-label="Grant Amount" />
                                                            <label for="floatingAmount">Grant Amount</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <div class="form-floating">
                                                            <select asp-for="newGrant.category" class="form-select" id="floatingCategory" aria-label="Grant Category">
                                                                <option value="Federal">Federal</option>
                                                                <option value="State">State</option>
                                                                <option value="Foundation">Foundation</option>
                                                                <option value="Other">Other</option>
                                                            </select>
                                                            <label for="floatingCategory">Grant Category</label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <div class="form-floating">
                                                        <select asp-for="newGrant.grantStatus" class="form-select" id="floatingStatus" aria-label="Grant Status">
                                                            <option value="Potential">Potential</option>
                                                            <option value="Funded">Funded</option>
                                                            <option value="Active">Active</option>
                                                            <option value="Rejected">Rejected</option>
                                                            <option value="Archived">Archived</option>
                                                        </select>
                                                        <label for="floatingStatus">Grant Status</label>
                                                    </div>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancel</button>
                                                    <button type="submit" class="btn btn-primary">
                                                        Save Changes
                                                    </button>
                                                </div>
                                            </form>
                                            @*<form method="post" asp-page="/ProjectNotes">
                                                        <input type="hidden" name="ProjectID" value="@prod.ProjectID" />
                                                        <button type="submit" class="btn btn-link btn-rounded btn-sm fw-bold" data-mdb-ripple-color="dark">
                                                            Notes
                                                        </button>
                                                    </form>*@
                                        </div>
                                    </div> <!--close modal content-->
                                </div> <!--close modal dialog-->
                            </div> <!--close modal-->
                        </div> <!--close grants tab-->
                        <!--projects tab-->
                        <div class="tab-pane fade" id="profile-tab-pane" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
                            <div class="btn-toolbar my-2 mb-md-0">
                                <form class="d-flex" role="search">
                                    <input class="form-control me-2" method="get" asp-page="/GrantsAndProjects" asp-route-tab="projects" type="search" name="ProjectSearchQuery" placeholder="Search" aria-label="Search">
                                    <button class="btn btn-secondary me-2 rounded-pill" type="submit">Search</button>
                                    <button class="btn btn-secondary me-2 rounded-pill" type="submit" name="ProjectSearchQuery" value="">Clear</button>
                                </form>
                                <button type="button" class="btn btn-secondary me-2 rounded-pill">
                                    <i class="fa-solid fa-filter"></i>
                                </button>
                                <button type="button" class="btn  btn-primary rounded-pill" data-bs-toggle="modal" data-bs-target="#createprojectModal">
                                    Create
                                    <i class="fa-solid fa-plus"></i>
                                </button>
                                @*<a href="/ProjectCreation" class="btn btn-primary rounded-pill">
                                    Create
                                    <i class="fa-solid fa-plus"></i>
                                </a>*@
                                <!--create project modal -->
                                <div class="modal fade" id="createprojectModal" tabindex="-1" aria-labelledby="createprojectModalLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h1 class="modal-title fs-5" id="createprojectModalLabel">Create New Project</h1>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <form method="post" asp-page-handler="InsertProject" class="form-floating">
                                                    <div class="row mb-4">
                                                        <h6>Project Information</h6>
                                                        <div class="col">
                                                            <div class="form-floating">
                                                                <input asp-for="newProject.ProjectName" type="text" class="form-control" id="floatingName" placeholder="Project Name">
                                                                <label for="floatingName">Project Name</label>
                                                            </div>
                                                        </div>
                                                        <div class="col">
                                                            <div class="form-floating">
                                                                <input asp-for="newProject.DateDue" type="date" class="form-control" id="floatingDate" placeholder="Due Date">
                                                                <label for="floatingDate">Due Date</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row mb-4">
                                                        <div class="col-sm-6">
                                                            <div class="form-floating">
                                                                <select asp-for="newProject.ProjectAdminID" class="form-select" id="floatingAdmin" aria-label="Principal Investigator">
                                                                    @foreach (var admin in Model.AdminList)
                                                                    {
                                                                        <option value="@admin.userID"> @admin.firstName @admin.lastName </option>
                                                                    });
                                                                </select>
                                                                <label for="floatingAdmin">Principal Investigator</label>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-6">
                                                            <div class="form-floating">
                                                                <select asp-for="newProject.ProjectStatus" class="form-select" id="floatingStatus" aria-label="Project Status">
                                                                    <option value="Incomplete">Incomplete</option>
                                                                    <option value="In Progress">In Progress</option>
                                                                    <option value="Complete">Complete</option>
                                                                </select>
                                                                <label for="floatingStatus">Project Status</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    @*<select class="form-select" asp-for="EmployeeIDs" multiple>
			                                            @{
				                                            foreach (var employee in Model.EmployeeList)
				                                            {
					                                            <option value="@employee.userID">@employee.firstName @employee.lastName</option>
				                                            }
			                                            }
		                                            </select>*@
                                                    <div class="col" style="height:100px;">
                                                        <div class="form-floating h-100">
                                                            <select asp-for="EmployeeIDs" class="form-select h-100" id="floatingEmployees" aria-label="Assign Employees" multiple>
                                                                @foreach (var employee in Model.EmployeeList)
                                                                {
                                                                    <option value="@employee.userID"> @employee.firstName @employee.lastName </option>
                                                                }
                                                            </select>
                                                            <label for="floatingEmployees">Assign Employees (hold ctrl to select multiple)</label>
                                                        </div>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancel</button>
                                                        <button type="submit" class="btn btn-primary">Create Project</button>
                                                    </div>
                                                </form>
                                            </div>
                                        </div> <!--close modal content-->
                                    </div> <!--close modal dialog-->
                                </div> <!--close modal-->
                            </div> <!--close btn toolbar-->
                            <!--project table-->
                            <div class="table-responsive table-bordered rounded small my-2">
                                <table id="projectTable" class="table align-middle mb-0 bg-white">
                                    <thead class="bg-light">
                                        <tr>
                                            <th>Project Name</th>
                                            <th>Contact</th>
                                            <th>Due date</th>
                                            <th>Status</th>
                                            <th>Funding Organization</th>
                                            <th>Notes</th>
                                            <th class="fw-bold">
                                                <button class="btn btn-rounded btn-sm fw-bold">
                                                    <i class="fa-solid fa-edit"></i>
                                                    Edit
                                                </button>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var prod in Model.ProjectList)
                                        {
                                            var statusClass = prod.ProjectStatus?.ToLower() switch
                                            {
                                                "in progress" => "badge bg-info text-dark",
                                                "opportunity" => "badge bg-primary",
                                                "pending" => "badge bg-warning text-dark",
                                                "approved" => "badge bg-success",
                                                "completed" => "badge bg-success",
                                                "rejected" => "badge bg-danger",
                                                _ => "badge bg-secondary"
                                            };


                                            <tr>
                                                <td>@prod.ProjectName</td>
                                                <td>
                                                    <div class="d-flex align-items-center">
                                                        @*<img src="https://mdbootstrap.com/img/new/avatars/8.jpg" alt="" style="width: 45px; height: 45px" class="rounded-circle">*@
                                                        <div class="ms-3">
                                                            <p class="fw-bold mb-1">@prod.AdminName</p>
                                                            <p class="text-muted mb-0">@prod.AdminEmail</p>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td>@prod.DateDue.ToShortDateString()</td>
                                                <td><span class="@statusClass">@prod.ProjectStatus</span></td>
                                                <td>Organization Name</td>
                                                <td>
                                                    <form method="post" asp-page="/ProjectNotes">
                                                        <input type="hidden" name="ProjectID" value="@prod.ProjectID" />
                                                        <button type="submit" class="btn btn-link btn-rounded btn-sm fw-bold" data-mdb-ripple-color="dark">
                                                            Notes
                                                        </button>
                                                    </form>
                                                </td>
                                                <td>
                                                    <form method="post" asp-page="/UpdateProject">
                                                        <input type="hidden" name="ProjectID" value="@prod.ProjectID" />
                                                        <button type="submit" class="btn btn-link btn-rounded btn-sm fw-bold" data-mdb-ripple-color="dark">
                                                            <i class="fa-solid fa-pen-to-square"></i>
                                                        </button>
                                                    </form>
                                                </td>

                                            </tr>

                                        }

                                    </tbody>
                                </table>
                            </div> <!--close table div-->
                        </div> <!--close projects tab-->

                    </div>

                </div> <!--close main content div-->

            </div> <!--close row-->
        </div> <!--close container-->

    </main>

    <script src="/docs/5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/4ccc3672e0.js" crossorigin="anonymous"></script>

    <script>
        var editModal = document.getElementById('editgrantModal');
        editModal.addEventListener('show.bs.modal', function (event) {
          var btn = event.relatedTarget;
          var modal = this;
          // grab the data- attributes
          var id       = btn.getAttribute('data-grant-id');
          var name     = btn.getAttribute('data-grant-name');
          var due      = btn.getAttribute('data-grant-duedate');
          var business = btn.getAttribute('data-grant-business');
          var category = btn.getAttribute('data-grant-category');
          var status   = btn.getAttribute('data-grant-status');
          var amount   = btn.getAttribute('data-grant-amount');

          // populate the inputs
          modal.querySelector('input[name="newGrant.GrantID"]').value      = id;
          modal.querySelector('input[name="newGrant.grantName"]').value    = name;
          modal.querySelector('input[name="newGrant.dueDate"]').value      = due;
          modal.querySelector('input[name="newGrant.businessName"]').value = business;
          modal.querySelector('select[name="newGrant.category"]').value    = category;
          modal.querySelector('select[name="newGrant.grantStatus"]').value = status;
          modal.querySelector('input[name="newGrant.amount"]').value       = amount;
        });
    </script>
    <script>
        document.getElementById('populateGrantBtn').addEventListener('click', function () {
            document.querySelector('input[name="newGrant.grantName"]').value = "REDI Research Support Center";
            document.querySelector('input[name="newGrant.dueDate"]').value = "2025-08-15";
            document.querySelector('input[name="newGrant.businessName"]').value = "Research Support Center";
            document.querySelector('input[name="newGrant.amount"]').value = "15000";

            // Clear or reset other optional dropdowns
            document.querySelector('select[name="newGrant.FacultyLeadID"]').selectedIndex = 0;
            document.querySelector('select[name="newGrant.BusinessPartnerID"]').selectedIndex = 0;
            document.querySelector('select[name="newGrant.category"]').selectedIndex = 0;
            document.querySelector('select[name="newGrant.grantStatus"]').selectedIndex = 0;
        });
    </script>
    <script>
        window.setTimeout(function () {
            const alertBox = document.getElementById('success-alert');
            if (alertBox) {
                //fade out
                alertBox.classList.remove('show');
                alertBox.classList.add('fade');
                setTimeout(() => alertBox.remove(), 500);
            }
        }, 4000); //4 seconds before starting fade-out
    </script>
    <script>
        window.setTimeout(function () {
            const alertBox = document.getElementById('failure-alert');
            if (alertBox) {
                //fade out
                alertBox.classList.remove('show');
                alertBox.classList.add('fade');
                setTimeout(() => alertBox.remove(), 500);
            }
        }, 4000); //4 seconds before starting fade-out
    </script>

</body>

</html>

