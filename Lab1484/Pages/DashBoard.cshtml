@page
@model Lab1484.Pages.DashBoardModel


@{
}

<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="YOUR DESCRIPTION HERE">
    <meta name="author" content="YOUR NAME HERE">
    <title>Test</title>

    <!-- LOAD BOOTSTRAP CSS - DO NOT DELETE -->
    <link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- Custom styles -->
    <link href="style.css" rel="stylesheet">
    <link rel="preconnect" href=https://fonts.googleapis.com>
    <link rel="preconnect" href=https://fonts.gstatic.com crossorigin>
    <link href=https://fonts.googleapis.com/css2?family =Bebas+Neue&family =Open+Sans:ital,wght@0,300..800;1,300..800&display =swap rel="stylesheet">

    <!-- Scripts -->
    <script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src=https://kit.fontawesome.com/4ccc3672e0.js crossorigin="anonymous"></script>
    <script src="~/js/script.js" asp-append-version="true"></script>
    <script src=https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js></script>
   <script src=https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

    <!-- FullCalendar CSS and JS -->
    <link href=https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css rel="stylesheet" />
    <script src=https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js></script>

    <style>
        /* Container settings */
        <style >
        #calendar {
            --fc-border-color: #450084;
            --fc-daygrid-event-dot-width: 10px;
            overflow-x: hidden;
            padding-right: 10px;
        }

        .fc-toolbar-title {
            color: #450084 !important;
        }

        .fc-daygrid-day-number {
            color: #450084 !important;
            font-weight: 600;
            z-index: 2;
            position: relative;
        }

        .fc-col-header-cell-cushion {
            color: #450084 !important;
            font-weight: bold;
        }

        .fc-scrollgrid,
        .fc-scrollgrid td,
        .fc-scrollgrid th {
            border-color: #450084 !important;
        }

        .fc .fc-daygrid-day {
            background-color: #DACCE6;
            min-width: 14.28%;
        }

        .fc-daygrid-event {
            white-space: normal !important;
            word-wrap: break-word;
            overflow: visible !important;
            padding: 2px 4px;
        }

            .fc-daygrid-event .fc-event-title {
                display: block;
                overflow: visible;
                white-space: normal;
                line-height: 1.2;
            }

        }

             .fc-day-today {
            background-color: #F4EFE1 !important;
        }
                
           
    </style>


</head>

<body>

   
                    <h1>Home</h1>
                    <div class="row">

                        <!--donut chart column-->
                        <div class="col-5">
                            <canvas id="grantsChart"></canvas>
                        </div> <!--close donut chart column-->
                        <!--calendar column-->

                        <div class="col-4 border-light-subtle rounded p-3">
                            <h4></h4>
                            <div id="calendar"></div>
                        </div> <!--close calendar column-->
                        <!--grants-->

                        <div class="col-12">
                            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 ">
                                <h2>All Grants</h2>
                                <div class="btn-toolbar mb-2 mb-md-0">
                                    <form class="d-flex" role="search">
                                        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                                        <button class="btn btn-outline-success me-2" type="submit">Search</button>
                                    </form>
                                    <button type="button" class="btn btn-outline-secondary me-2">
                                        <i class="fa-solid fa-filter"></i>
                                    </button>
                                    <a href="/GrantCreation" class="btn btn-outline-secondary">
                                        Create
                                        <i class="fa-solid fa-plus"></i>
                                    </a>
                                </div>
                            </div>
                        </div> <!--close grant column-->
                        <!--grant table-->
                        <div class="table-responsive table-bordered rounded small">
                            <table id="grantTable" class="table align-middle mb-0 bg-white">
                                <thead class="bg-light">
                                    <tr>
                                        <th>Grant Name</th>
                                       <th>Primary Investigator</th>
                                        <th>Amount</th>
                                        <th>Due date</th>
                                        <th>Status</th>
                                        <th>Funding Organization</th>
                                        <th>Category</th>
                                        <th><i class="fa-solid fa-edit"></i> Edit</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var prod in Model.GrantList)
                                    {
                                        var statusClass = prod.grantStatus?.ToLower() switch
                                        {
                                            "archived" => "badge bg-info text-dark",
                                            "active" => "badge bg-primary",
                                            "potential" => "badge bg-warning text-dark",
                                            "funded" => "badge bg-success",
                                            "rejected" => "badge bg-danger",
                                            _ => "badge bg-secondary"
                                        };

                                      <tr>
                                            <td>@prod.grantName</td>
                                            <td>
                                                <div class="d-flex align-items-center">
                                                    <div class="ms-3">
                                                        <p class="fw-bold mb-1">@prod.facultyName</p>
                                                        <p class="text-muted mb-0">@prod.facultyEmail</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>@prod.amount.ToString("C")</td>
                                            <td>@prod.dueDate.ToShortDateString()</td>
                                            <td><span class="@statusClass">@prod.grantStatus</span></td>
                                            <td>@prod.businessName</td>
                                            <td>@prod.category</td>
                                            <td>
                                                <a asp-page="/UpdateGrant" class="btn btn-link btn-rounded btn-sm fw-bold">
                                                    <i class="fa-solid fa-pen-to-square"></i>
                                                </a>
                                           </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div> <!--close table div-->
                    </div> <!--close grants col-->

                </div> <!--close main content row-->
           
      

    </main>


    <!-- FullCalendar initialization script -->
    <
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var calendarEl = document.getElementById('calendar');

            var calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                height: 500,
                eventDisplay: 'block', 
                eventDidMount: function (info) {
                    info.el.setAttribute('title', info.event.title);
                    info.el.style.whiteSpace = "normal";
                    info.el.style.overflow = "visible";
                },
                events: [
        @foreach (var grant in Model.GrantList)
        {
            <text>{
                            title: "@grant.grantName (Grant)",
                            start: "@grant.dueDate.ToString("yyyy-MM-dd")",
                            color: "#4B0082"
                                    }, </text>
        }

        @foreach (var project in Model.ProjectList)
        {
            if (project.DateDue != DateTime.MinValue)
            {
                <text>{
                                title: "@project.ProjectName (Project)",
                                start: "@project.DateDue.ToString("yyyy-MM-dd")",
                                color: "#800080"
                                            }, </text>
            }
        }

        @foreach (var task in Model.TaskList)
        {
            if (task.dueDate.HasValue)
            {
                <text>{
                                title: "@task.taskDescription (Task)",
                                start: "@task.dueDate.Value.ToString("yyyy-MM-dd")",
                                color: "#BA55D3"
                                            }, </text>
            }
        }
                            ]
            });

            calendar.render();
        });
    </script>


</body>
</html>