@page
@model Lab1484.Pages.DashBoardModel

@{
    <h1>OrgGrant Dashboard and Display</h1>
    <br />
    <h2>List of Currently Live Projects</h2>

    <!-- Updated to fix broken page when selected -->
    <form asp-page-handler="SingleSelect" method="post">
        <select asp-for="ProjectList" class="form-select">
            @foreach (var prod in Model.ProjectList)
            {
                <option value="@prod.ProjectID">@prod.ProjectName</option>
            }
        </select>
        <br />

    </form>
    <br />
    <h2>Project View</h2>
    <table class="table table-bordered table-responsive table-hover">
        <thead>
            <tr>
                <th>Project Name:</th>
                <th>Date Due:</th>
                <th>Date Created:</th>
                <th>Date Completed</th>
                <th>Admin Name</th>
                <th>Notes</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var prod in Model.ProjectList)
            {
                <tr>
                    <td>@prod.ProjectName</td>
                    <td>@prod.DateDue</td>
                    <td>@prod.DateCreated</td>
                    <td>@prod.DateCompleted</td>
                    <td>@prod.AdminName</td>
                    <td>@prod.noteBody</td>
                </tr>
            }
        </tbody>
    </table>

    <h2>Grant View</h2>
    <table class="table table-bordered table-responsive table-hover">
        <thead>
            <tr>
                <th>Grant Name:</th>
                <th>Grant Amount:</th>
                <th>Submission Date:</th>
                <th>Award Date:</th>
                <th>Faculty Name:</th>
                <th>Grant Status:</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var prod in Model.GrantList)
            {
                var statusClass = prod.grantStatus?.ToLower() switch
                {
                    "applied" => "badge bg-warning text-dark",
                    "pending" => "badge bg-warning text-dark",
                    "accepted" => "badge bg-success",
                    "rejected" => "badge bg-danger",
                    "completed" => "badge bg-light text-dark",
                    "opportunity" => "badge bg-primary",
                    _ => "badge bg-secondary"
                };

                <tr>
                    <td>@prod.businessName</td>
                    <td>@prod.amount</td>
                    <td>@prod.submissionDate</td>
                    <td>@prod.awardDate</td>
                    <td>@prod.facultyName</td>
                    <td><span class="@statusClass">@prod.grantStatus</span></td>
                </tr>
            }
        </tbody>
    </table>
}