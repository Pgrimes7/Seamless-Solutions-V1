@page
@model Lab1484.Pages.TasksModel
@{
    ViewData["Title"] = "Tasks";
}


<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="YOUR DESCRIPTION HERE">
    <meta name="author" content="YOUR NAME HERE">
    <title>Test</title>

    <!-- LOAD BOOTSTRAP CSS - DO NOT DELETE -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- END LOADING BOOTSTRAP CSS -->
    <!-- Custom styles - add your own CSS to this stylesheet -->
    <link href="~/css/style.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">

    <!-- DO NOT DELETE -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/4ccc3672e0.js" crossorigin="anonymous"></script>
    <script src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <!-- DO NOT DELETE -->
</head>

@* <body> *@

@*     <div class="container-fluid"> *@
@*         <div class="row flex-nowrap"> *@


@*             <!--main content col--> *@
@*             <div class="col py-3"> *@
@*                 <h1>Tasks</h1> *@

@*                 <!--row for create task button--> *@
@*                 <div class="row row-cols-auto"> *@
@*                     <div class="col my-2 mb-md-0"> *@
@*                         <button type="button" class="btn btn-primary rounded-pill" data-bs-toggle="modal" data-bs-target="#createtaskModal"> *@
@*                             Create *@
@*                             <i class="fa-solid fa-plus"></i> *@
@*                         </button> *@
@*                     </div> *@
@*                 </div> *@

@*                 <!--create task modal --> *@
@*                 <div class="modal fade" id="createtaskModal" tabindex="-1" aria-labelledby="createtaskModalLabel" aria-hidden="true"> *@
@*                     <div class="modal-dialog modal-dialog-centered"> *@
@*                         <div class="modal-content"> *@
@*                             <div class="modal-header"> *@
@*                                 <h1 class="modal-title fs-5" id="createtaskModalLabel">Create New Task</h1> *@
@*                                 <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> *@
@*                             </div> *@
@*                             <form method="post"> *@
@*                                 <div class="modal-body"> *@
@*                                         <div class="row mb-4"> *@
@*                                             <div class="col-sm-6"> *@
@*                                                 <div class="form-floating"> *@
@*                                                     <select asp-for="NewTask.ProjectID" id="floatingProj" class="form-select" aria-label="Default select example"> *@
@*                                                         @foreach (var proj in Model.projects) { *@
@*                                                             <option value="@proj.ProjectID">@proj.ProjectName</option> *@
@*                                                         } *@
@*                                                     </select> *@
@*                                                     <label for="floatingProj" class="form-label">Associated Project</label> *@
@*                                                 </div> *@
@*                                             </div> *@
@* 										    <div class="col-sm-6"> *@
@*                                                 <div class="form-floating"> *@
@*                                                     <input asp-for="NewTask.dueDate" type="date" class="form-control" id="floatingDate" placeholder="Due Date"> *@
@*                                                     <label for="floatingDate">Due Date</label> *@
@*                                                 </div> *@
@*                                             </div> *@
@*                                         </div> *@
@*                                         <hr> *@
@*                                         <div class="row"> *@
@*                                             <div class="col"> *@
@*                                             <label asp-for="NewTask.taskDescription" class="form-label">Task Description</label> *@
@*                                                 <div class="form-floating mb-4"> *@
@*                                                 <input asp-for="NewTask.taskDescription" type="text" class="form-control" id="floatingTaskDesc" placeholder="Enter Task Description" required *@
@*                                                        oninvalid="this.setCustomValidity('Please enter a task description')" *@
@*                                                        oninput="this.setCustomValidity('')"> *@
@*                                                     <label for="floatingTaskDesc">Task Description</label> *@
@*                                                 </div> *@
@*                                             </div> *@
@*                                         </div> *@
@*                                 </div> *@
@*                                 <div class="modal-footer"> *@
@*                                         <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancel</button> *@
@*                                         <button type="submit" class="btn btn-primary">Assign Task</button> *@
@*                                 </div> *@
@*                             </form> *@
@*                         </div> <!--close modal content--> *@
@*                     </div> <!--close modal dialog--> *@
@*                 </div> <!--close modal--> *@
@*                 <!--task table--> *@
@*                 <div class="table-responsive table-bordered rounded small my-2"> *@
                    
@*                 <!--grant task table--> *@
@*                 <div class="table-responsive table-bordered rounded small my-2"> *@
                    
@*                 </div> <!--close table--> *@
@*             </div> <!--close tasks tab--> *@
@*         </div> <!--close main content row--> *@
@*     </div> <!--close main content col--> *@
@*     </div> <!--close row--> *@
@*     </div> <!--close container--> *@

@*     <script src="/docs/5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script> *@
@*     <script src="https://kit.fontawesome.com/4ccc3672e0.js" crossorigin="anonymous"></script> *@

@* </body> *@

<body>

    <main>




        <div class="container-fluid">
            <div class="row flex-nowrap">


                <!--main content div-->
                <div class="col py-3">
                    <h1>Tasks for Grants and Projects</h1>

                    <!--tabs-->
                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li role="presentation">
                            <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home-tab-pane" type="button" role="tab" aria-controls="home-tab-pane" aria-selected="true">
                                Grants
                            </button>
                        </li>
                        <li role="presentation">
                            <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile-tab-pane" type="button" role="tab" aria-controls="profile-tab-pane" aria-selected="false">
                                Projects
                            </button>
                        </li>
                    </ul>

                    <!--tabs content-->
                    <div class="tab-content" id="myTabContent">

                        <!--grants tab-->
                        <div class="tab-pane fade show active" id="home-tab-pane" role="tabpanel" aria-labelledby="home-tab" tabindex="0">
                            <div class="btn-toolbar my-2 mb-md-0">
                                <!--create grant task button trigger modal-->
                                <button type="button" class="btn btn-primary rounded-pill" data-bs-toggle="modal" data-bs-target="#creategrantModal">
                                    Create
                                    <i class="fa-solid fa-plus"></i>
                                </button>
                            </div> <!--close btn toolbar-->
                            <!--create task modal -->
                            <div class="modal fade" id="createtaskModal" tabindex="-1" aria-labelledby="createtaskModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered">
                                     <div class="modal-content">
                                         <div class="modal-header">
                                             <h1 class="modal-title fs-5" id="createtaskModalLabel">Create New Task</h1>
                                             <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                         </div>
                                         <form method="post">
                                             <div class="modal-body">
                                                     <div class="row mb-4">
                                                         <div class="col-sm-6">
                                                             <div class="form-floating">
                                                                 <select asp-for="NewTask.ProjectID" id="floatingProj" class="form-select" aria-label="Default select example">
                                                                     @foreach (var proj in Model.projects) {
                                                                         <option value="@proj.ProjectID">@proj.ProjectName</option>
                                                                     }
                                                                 </select>
                                                                 <label for="floatingProj" class="form-label">Associated Project</label>
                                                             </div>
                                                         </div>
 										                <div class="col-sm-6">
                                                             <div class="form-floating">
                                                                 <input asp-for="NewTask.dueDate" type="date" class="form-control" id="floatingDate" placeholder="Due Date" />                                                     <label for="floatingDate">Due Date</label>
                                                             </div>
                                                         </div>
                                                     </div>
                                                     <hr>
                                                     <div class="row">
                                                         <div class="col">
                                                         <label asp-for="NewTask.taskDescription" class="form-label">Task Description</label>
                                                             <div class="form-floating mb-4">
                                                             <input asp-for="NewTask.taskDescription" type="text" class="form-control" id="floatingTaskDesc" placeholder="Enter Task Description" required
                                                                    oninvalid="this.setCustomValidity('Please enter a task description')"
                                                                    oninput="this.setCustomValidity('')">
                                                                 <label for="floatingTaskDesc">Task Description</label>
                                                             </input>
                                                             </div>
                                                         </div>
                                                     </div>
                                             </div>
                                             <div class="modal-footer">
                                                     <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancel</button>
                                                     <button type="submit" class="btn btn-primary">Assign Task</button>
                                             </div>
                                         </form>
                                     </div> <!--close modal content-->
                                 </div> <!--close modal dialog-->
                             </div> <!--close modal-->
                            <!--grant table-->
                            <div class="table-responsive table-bordered rounded small my-2">
                                <table id="grantTable" class="table align-middle mb-0 bg-white">
                                    <thead class="bg-light">
                                        <tr>
                                            <th scope="col">Related User</th>
                                            <th scope="col">Related Grant</th>
                                            <th scope="col">Description</th>
                                            <th scope="col">Due Date</th>
                                            <th scope="col">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var gtask in Model.gtasks)
                                        {
                                            <tr>
                                                <td>@gtask.UserName</td>
                                                <td>@gtask.GrantName</td>
                                                <td>@gtask.taskDescription</td>
                                                <td>@(gtask.dueDate.HasValue ? gtask.dueDate.Value.ToShortDateString() : "N/A")</td>
                                                <td>@gtask.GTStatus</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div> <!--close table div-->
                        </div> <!--close grants tab-->
                        <!--projects tab-->
                        <div class="tab-pane fade" id="profile-tab-pane" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
                            <div class="btn-toolbar my-2 mb-md-0">
                                <!--create project task button trigger modal-->
                                <button type="button" class="btn btn-primary rounded-pill" data-bs-toggle="modal" data-bs-target="#creategrantModal">
                                    Create
                                    <i class="fa-solid fa-plus"></i>
                                </button>
                            </div> <!--close btn toolbar-->
                            <!--project task table-->
                            <div class="table-responsive table-bordered rounded small my-2">
                                <table id="grantTable" class="table align-middle mb-0 bg-white">
                                    <thead class="bg-light">
                                        <tr>
                                            <th scope="col">Related User</th>
                                            <th scope="col">Related Project</th>
                                            <th scope="col">Description</th>
                                            <th scope="col">Due Date</th>
                                            <th scope="col">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var task in Model.tasks)
                                        {
                                            <tr>
                                                <td>@task.UserName</td>
                                                <td>@task.ProjectName</td>
                                                <td>@task.taskDescription</td>
                                                <td>@(task.dueDate.HasValue ? task.dueDate.Value.ToShortDateString() : "N/A")</td>
                                                <td>@task.PTStatus</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div> <!--close table-->
                        </div> <!--close projects tab-->

                    </div>

                </div> <!--close main content div-->

            </div> <!--close row-->
        </div> <!--close container-->

    </main>

    <script src="/docs/5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/4ccc3672e0.js" crossorigin="anonymous"></script>

    <script>
        var editModal = document.getElementById('editgrantModal');
        editModal.addEventListener('show.bs.modal', function (event) {
          var btn = event.relatedTarget;
          var modal = this;
          // grab the data- attributes
          var id       = btn.getAttribute('data-grant-id');
          var name     = btn.getAttribute('data-grant-name');
          var due      = btn.getAttribute('data-grant-duedate');
          var business = btn.getAttribute('data-grant-business');
          var category = btn.getAttribute('data-grant-category');
          var status   = btn.getAttribute('data-grant-status');
          var amount   = btn.getAttribute('data-grant-amount');

          // populate the inputs
          modal.querySelector('input[name="newGrant.GrantID"]').value      = id;
          modal.querySelector('input[name="newGrant.grantName"]').value    = name;
          modal.querySelector('input[name="newGrant.dueDate"]').value      = due;
          modal.querySelector('input[name="newGrant.businessName"]').value = business;
          modal.querySelector('select[name="newGrant.category"]').value    = category;
          modal.querySelector('select[name="newGrant.grantStatus"]').value = status;
          modal.querySelector('input[name="newGrant.amount"]').value       = amount;
        });
    </script>

</body>

</html>
