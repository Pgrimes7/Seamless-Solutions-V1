CREATE DATABASE Lab2;

USE Lab2;

--User Table
CREATE TABLE Users (
	UserID INT IDENTITY(1,1) PRIMARY KEY,
	userType INT NOT NULL, --0=Admin, 1=Faculty, 2=Employee, 3=Representative
	firstName NVARCHAR(50),
	lastName NVARCHAR(50),
	email NVARCHAR(50),
	phoneNumber NVARCHAR(20)
);

--Credentials Table
CREATE TABLE Credentials (
	CredentialsID INT IDENTITY(1,1) PRIMARY KEY,
	Username nvarchar(200),
	Password nvarchar(200),
	UserID INT,
	FOREIGN KEY (UserID) REFERENCES Users(UserID)
);

--Hashed Credentials Table
CREATE TABLE HashedCredentials (
	HashedCredentialsID INT IDENTITY(1,1) PRIMARY KEY,
	Username nvarchar(200),
	Password nvarchar(200)
);

--Project Table
CREATE TABLE Project (
	ProjectID INT IDENTITY(1,1) PRIMARY KEY,
	ProjectAdminID INT,
	projectStatus NVARCHAR(50),
	dateCreated DATE,
	dateCompleted DATE,
	dueDate DATE,
	ProjectName VARCHAR(50),
	FOREIGN KEY (ProjectAdminID) REFERENCES Users(UserID)
);

--EmployeeProject Table (Made so that multiple employees can be linked to a project)
CREATE TABLE  EmployeeProject(
	ProjectID INT,
	EmployeeID INT,
	PRIMARY KEY (ProjectID, EmployeeID),
	FOREIGN KEY (ProjectID) REFERENCES Project(ProjectID),
	FOREIGN KEY (EmployeeID) REFERENCES Users(UserID)
);

--Tasks Table (For Projects)
CREATE TABLE Tasks (
	TaskID INT IDENTITY(1,1) PRIMARY KEY,
	ProjectID INT,
	taskDescription NVARCHAR(200),
	FOREIGN KEY (ProjectID) REFERENCES Project(ProjectID)
);

--Notes Table (For Projects)
CREATE TABLE Notes (
	NoteID INT IDENTITY(1,1) PRIMARY KEY,
	ProjectID INT,
	noteBody NVARCHAR(200),
	FOREIGN KEY (ProjectID) REFERENCES Project(ProjectID)
);

--BusinessPartner Table (Separate from Users to minimize the amount of permissions they have)
CREATE TABLE BusinessPartner (
	BusinessPartnerID INT IDENTITY(1,1) PRIMARY KEY,
	RepresentativeID INT,
	firstName NVARCHAR(50),
	lastName NVARCHAR(50),
	orgType NVARCHAR(50),
	businessType NVARCHAR(50),
	statusFlag NVARCHAR(50),
	FOREIGN KEY (RepresentativeID) REFERENCES Users(UserID)
);

--MeetingMinutes Table (For BusinessPartners)
CREATE TABLE MeetingMinutes (
	MinutesID INT IDENTITY(1,1) PRIMARY KEY,
	BusinessPartnerID INT,
	minutesBody NVARCHAR(200),
	FOREIGN KEY (BusinessPartnerID) REFERENCES BusinessPartner(BusinessPartnerID)
);

--Grant Table
CREATE TABLE Grants (
	GrantID INT IDENTITY(1,1) PRIMARY KEY,
	FacultyLeadID INT,
	BusinessPartnerID INT,
	businessName NVARCHAR(100),
	category NVARCHAR(50),
	submissionDate DATE,
	awardDate DATE,
	grantStatus NVARCHAR(50),
	amount FLOAT,
	FOREIGN KEY (FacultyLeadID) REFERENCES Users(UserID),
	FOREIGN KEY (BusinessPartnerID) REFERENCES BusinessPartner(BusinessPartnerID)
);

--FacultyGrant Table (Made so that multiple faculty members can be linked to a grant)
CREATE TABLE FacultyGrant (
	GrantID INT,
	FacultyID INT,
	PRIMARY KEY (GrantID, FacultyID),
	FOREIGN KEY (GrantID) REFERENCES Grants(GrantID),
	FOREIGN KEY (FacultyID) REFERENCES Users(UserID)
);

--Messages Table
CREATE TABLE Messages (
    MessageID INT IDENTITY(1,1) PRIMARY KEY,
    Sender NVARCHAR(50) NOT NULL,
    Receiver NVARCHAR(50) NOT NULL,
    Content NVARCHAR(MAX) NOT NULL,
    Timestamp DATETIME DEFAULT GETDATE(),
    IsRead BIT DEFAULT 0
);




INSERT INTO Users (userType, firstName, lastName, email, phoneNumber) 
VALUES (0, 'Todd', 'Smith', 'Todd.smith@example.com', '123-456-7890'),
       (1, 'Grant', 'Gorber', 'Grant.Gorber@example.com', '234-567-8901'),
       (2, 'Charlie', 'Brown', 'charlie.brown@example.com', '345-678-9012'),
       (3, 'Bowwow', 'Jordan', 'Bowow@example.com', '456-789-0123'),
	   (0, 'Boss', 'Man', 'BossMan@example.com', '123-456-7890'),
       (1, 'Johnson', 'Brant', 'Grahhh@example.com', '234-567-8901'),
       (2, 'Bulh', 'Gomber', 'Gomber@example.com', '345-678-9012'),
       (3, 'Magnus', 'Yang', 'Bowow@example.com', '456-789-0123');

INSERT INTO Credentials (Username, Password, UserID) 
VALUES ('smithto','12345',1),
	('gorbergr','67890',2),
	('brownch','24680',3),
	('jordanbow','13579',4),
	('manbos','54321',5),
	('brantjo','09876',6),
	('gomberbu','08642',7),
	('yangmag','97531',8);

INSERT INTO Project (ProjectAdminID, projectStatus, dateCreated, dateCompleted, dueDate, ProjectName) 
VALUES (1, 'In Progress', '2025-01-01', '2000-10-10', '2025-12-31', 'Cancer Research'),
       (2, 'Completed', '2024-01-01', '2024-12-31', '2024-12-31', 'Project LeBron');
	   
INSERT INTO EmployeeProject (ProjectID, EmployeeID) 
VALUES (1, 2),
       (1, 3),
       (2, 2);

INSERT INTO Tasks (ProjectID, taskDescription) 
VALUES (1, 'Task 1 '),
       (1, 'Task 2 '),
       (2, 'Task 1');

INSERT INTO Notes (ProjectID, noteBody) 
VALUES (1, 'Note 1'),
       (1, 'Note 2 '),
       (2, 'Note 1 ');

INSERT INTO BusinessPartner (RepresentativeID, firstName, lastName, orgType, businessType, statusFlag) 
VALUES (3, 'LeBron', 'James', 'Sports', 'Athletics', 'Active'),
       (4, 'Bob', 'Jordan', 'For-Profit', 'Technology', 'Inactive');

INSERT INTO MeetingMinutes (BusinessPartnerID, minutesBody) 
VALUES (1, 'Meeting minutes ex'),
       (2, 'Meeting minutes ex');

INSERT INTO Grants (FacultyLeadID, BusinessPartnerID, businessName, category, submissionDate, awardDate, grantStatus, amount) 
VALUES (1, 1, 'Business A', 'Research', '2025-01-15', '2025-02-15', 'Approved', 50000.00),
       (2, 2, 'Business B', 'Development', '2025-03-01', '2025-04-01', 'Pending', 75000.00);

INSERT INTO FacultyGrant (GrantID, FacultyID) 
VALUES (1, 1),
       (1, 2),
       (2, 1);

INSERT INTO Messages (Sender, Receiver, Content, IsRead)
VALUES ('smithto', 'brownch', 'Just wanted to send a reminder about the project"s upcoming due date.', 1),
       ('brownch', 'smithto', 'Thanks for the reminder!', 0),
       ('gomberbu', 'smithto', 'Could we look at this later?', 0),
	   ('manbos', 'brownch', 'Reminder of the upcoming due date of the project!', 1),
       ('brownch', 'manbos', 'Thank you!', 0),
       ('jordanbow', 'brantjo', 'I have a question I would like to talk with you about.', 1),
	   ('brantjo', 'jordanbow', 'When would you be available to discuss?', 0),
       ('yangmag', 'grobergr', 'Are we still able to meet about this tomorrow?', 0);
